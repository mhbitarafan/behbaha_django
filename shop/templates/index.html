{% extends 'base.html' %}
{% load jalali_tags %}
{% load shop_tags %}
{% block title %}خرید جمعی و ارزان{% endblock title %}
{% block content %}
<div class="products-filters-sidebar col-12 col-md-3 col-lg-2 text-right p-2 px-2">
    <div class="d-flex flex-column">
        <div class="d-flex flex-column border-bottom">
            <div>شهر</div>
            <v-select dir="rtl" :clearable="false" :options="provinces" v-model="selected_city" class="mt-2 bg-light">
            </v-select>
        </div>
        <div class="d-flex flex-column border-bottom p-2">
            <div>نوع مصرف</div>
            <div class="d-flex flex-row mt-3">
                <a name="" id="" class="btn btn-light ml-2" href="#" role="button">خانگی</a>
                <a name="" id="" class="btn btn-light" href="#" role="button">صنعتی</a>
            </div>
        </div>
    </div>
    <div class="d-flex flex-column mt-2">
        <div class="d-flex flex-column border-bottom p-2">
            <div>قیمت</div>
            <div class="mt-2 ml-2">حداقل</div>
            <input class="mt-1 p-2 rounded border" v-model="min_price" @input="set_price_filter(min_price, 'm')"
                type="string" name="min-price" id="min-price">
            <div class="mt-2 ml-2">حداکثر</div>
            <input class="mt-1 p-2 rounded border" v-model="max_price" @input="set_price_filter(max_price, 'h')"
                type="string" name="max-price" id="max-price">
        </div>
    </div>
    <button class="btn btn-primary m-2" @click="filter_products(min_price, max_price)">فیلتر کن</button>
</div>
<div class="d-flex flex-column col-12 col-md col-lg align-items-center p-0 justify-content-between" dir="ltr" style="overflow: auto;"
    :style="cards_container_height">
    {% comment %} <div v-if="shw_products" class="product-cards w-100 p-3">
        {% for product in products %}
        <product-card pid="{{forloop.counter0}}" title="{{product.title}}" image="media/{{product.featured_image}}"
            max_order="{{product.max_order}}" ordered_num="{{product.ordered_num}}"
            delivery_date="{{product.deliver_at|to_jalali}}" time_remaining="{{product.deliver_at|calc_time_remining}}"
            prices="{{product.prices}}"></product-card>
        <product-details-box pid="{{forloop.counter0}}" title="{{product.title}}" desc="{{product.description}}"
            image="media/{{product.featured_image}}" max_order="{{product.max_order}}"
            ordered_num="{{product.ordered_num}}" delivery_date="{{product.deliver_at|to_jalali}}"
            time_remaining="{{product.deliver_at|calc_time_remining}}" prices="{{product.prices}}"
            order_ranges="{{product.order_ranges}}"></product-details-box>

        {% endfor %}
    </div> {% endcomment %}
    <div v-if="shw_products" class="product-cards w-100 p-3">
        <product-card v-for="(product, index) in products" :key="index" :pid="index" :title="product.title"
            :image="product.featured_image" :max_order="product.max_order" :ordered_num="product.ordered_num"
            :delivery_date="product.deliver_at" :time_remaining="product.remaining_time" :prices="product.prices">
        </product-card>
        <product-details-box v-for="(product, index) in products" :key="index" :pid="index" :title="product.title"
            :desc="product.description" :image="product.featured_image" :max_order="product.max_order"
            :ordered_num="product.ordered_num" :delivery_date="product.deliver_at"
            :time_remaining="product.remaining_time" :prices="product.prices" :order_ranges="product.order_ranges">
        </product-details-box>
    </div>
    <div v-if="shw_api_results" class="product-cards w-100 p-3">
        <product-card v-for="(product, index) in search_products" :key="index" :pid="index" :title="product.title"
            :image="product.featured_image" :max_order="product.max_order" :ordered_num="product.ordered_num"
            :delivery_date="product.deliver_at" :time_remaining="product.remaining_time" :prices="product.prices">
        </product-card>
        <product-details-box v-for="(product, index) in products" :key="index" :pid="index" :title="product.title"
            :desc="product.description" :image="product.featured_image" :max_order="product.max_order"
            :ordered_num="product.ordered_num" :delivery_date="product.deliver_at"
            :time_remaining="product.remaining_time" :prices="product.prices" :order_ranges="product.order_ranges">
        </product-details-box>
    </div>
    <div v-if="!next_disabled" class="page-numbers-container row py-2 text-center justify-content-center w-100">
        <button :disabled="next_disabled" class="btn btn-outline-dark py-2" @click="next_page_f()">
            <i class="fa fa-chevron-double-down" aria-hidden="true"></i>
            محصولات بیشتر
        </button>
    </div>
</div>
{% endblock content %}